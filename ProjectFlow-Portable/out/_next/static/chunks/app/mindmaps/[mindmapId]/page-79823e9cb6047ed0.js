(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{4248:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6874,23)),Promise.resolve().then(s.bind(s,9590)),Promise.resolve().then(s.bind(s,5506))},9590:(e,t,s)=>{"use strict";s.d(t,{default:()=>f});var n=s(5155),l=s(2115),i=s(285),a=s(6695),o=s(6126),r=s(5506),c=s(4961);function d(e){var t,s,l;let{node:i,isSelected:a,onDragStart:o,onSelect:r}=e,d=c.JN[i.type],h=i.width||120,x=i.height||50,u=d.fontSize,m=d.fontWeight;return(0,n.jsxs)("g",{className:"cursor-move hover:opacity-80 transition-opacity",onMouseDown:e=>{e.stopPropagation(),o(i.id,e)},onClick:e=>{e.stopPropagation(),r(i.id)},children:[a&&(0,n.jsx)("rect",{x:i.x-h/2-4,y:i.y-x/2-4,width:h+8,height:x+8,fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:"5,5",rx:d.rx+4}),(0,n.jsx)("rect",{x:i.x-h/2,y:i.y-x/2,width:h,height:x,fill:i.color||d.fill,stroke:a?"#3b82f6":d.stroke,strokeWidth:a?2:d.strokeWidth,rx:d.rx,className:"drop-shadow-sm"}),(null==(t=i.metadata)?void 0:t.priority)&&(0,n.jsx)("circle",{cx:i.x+h/2-8,cy:i.y-x/2+8,r:"4",fill:(e=>{switch(e){case"urgent":return"#ef4444";case"high":return"#f97316";case"medium":return"#eab308";case"low":return"#22c55e";default:return"transparent"}})(i.metadata.priority)}),"task"===i.type&&(0,n.jsx)("rect",{x:i.x-h/2+4,y:i.y-x/2+4,width:"8",height:"8",fill:"#f59e0b",rx:"2"}),(0,n.jsx)("text",{x:i.x,y:i.y,textAnchor:"middle",dominantBaseline:"middle",fontSize:u,fontWeight:m,fill:"leaf"===i.type?"#374151":"white",className:"pointer-events-none select-none",children:i.text.length>15?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("tspan",{x:i.x,dy:"-0.3em",children:i.text.substring(0,15)}),(0,n.jsx)("tspan",{x:i.x,dy:"1.2em",children:i.text.substring(15)})]}):i.text}),(null==(s=i.metadata)?void 0:s.assignee)&&(0,n.jsx)("circle",{cx:i.x-h/2+12,cy:i.y+x/2-8,r:"6",fill:"#10b981"}),(null==(l=i.metadata)?void 0:l.assignee)&&(0,n.jsx)("text",{x:i.x-h/2+12,y:i.y+x/2-8,textAnchor:"middle",dominantBaseline:"middle",fontSize:"8",fontWeight:"bold",fill:"white",className:"pointer-events-none select-none",children:i.metadata.assignee.split(" ").map(e=>e[0]).join("")}),(0,n.jsx)("circle",{cx:i.x,cy:i.y-x/2,r:"3",fill:"#6b7280",className:"opacity-0 group-hover:opacity-100 transition-opacity"}),(0,n.jsx)("circle",{cx:i.x+h/2,cy:i.y,r:"3",fill:"#6b7280",className:"opacity-0 group-hover:opacity-100 transition-opacity"}),(0,n.jsx)("circle",{cx:i.x,cy:i.y+x/2,r:"3",fill:"#6b7280",className:"opacity-0 group-hover:opacity-100 transition-opacity"}),(0,n.jsx)("circle",{cx:i.x-h/2,cy:i.y,r:"3",fill:"#6b7280",className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})}function h(e){let t,s,l,i,{connection:a,nodes:o}=e,r=o.find(e=>e.id===a.fromNodeId),c=o.find(e=>e.id===a.toNodeId);if(!r||!c)return null;let d=r.width||120,h=r.height||50,x=c.width||120,u=c.height||50,m=c.x-r.x,f=c.y-r.y,p=Math.sqrt(m*m+f*f);if(0===p)return null;Math.abs(m)>Math.abs(f)?(t=m>0?r.x+d/2:r.x-d/2,s=r.y):f>0?(t=r.x,s=r.y+h/2):(t=r.x,s=r.y-h/2),Math.abs(m)>Math.abs(f)?(l=m>0?c.x-x/2:c.x+x/2,i=c.y):f>0?(l=c.x,i=c.y-u/2):(l=c.x,i=c.y+u/2);let g=(()=>{if("curved"===a.style){let e=Math.min(p/3,100),n=t+(m>0?e:-e),a=s,o=l-(m>0?e:-e),r=i;return"M ".concat(t," ").concat(s," C ").concat(n," ").concat(a,", ").concat(o," ").concat(r,", ").concat(l," ").concat(i)}if(!(Math.abs(m)>50&&Math.abs(f)>50))return"M ".concat(t," ").concat(s," L ").concat(l," ").concat(i);{let e=t+m/2;return"M ".concat(t," ").concat(s," L ").concat(e," ").concat(s," L ").concat(e," ").concat(i," L ").concat(l," ").concat(i)}})(),y="arrow-".concat(a.id);return(0,n.jsxs)("g",{children:[(0,n.jsx)("defs",{children:(0,n.jsx)("marker",{id:y,viewBox:"0 0 10 10",refX:"9",refY:"3",markerWidth:"6",markerHeight:"6",orient:"auto",markerUnits:"strokeWidth",children:(0,n.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:a.color})})}),(0,n.jsx)("path",{d:g,stroke:a.color,strokeWidth:"2",fill:"none",strokeDasharray:"dashed"===a.style?"5,5":"none",markerEnd:"url(#".concat(y,")"),className:"hover:stroke-blue-500 transition-colors cursor-pointer"}),(0,n.jsx)("path",{d:g,stroke:"transparent",strokeWidth:"10",fill:"none",className:"cursor-pointer"})]})}function x(e){let{mindMap:t,onNodeUpdate:s,onNodeSelect:i,selectedNodeId:a,onAddNode:o}=e,r=(0,l.useRef)(null),[c,x]=(0,l.useState)(!1),[u,m]=(0,l.useState)(null),[f,p]=(0,l.useState)({x:0,y:0}),[g,y]=(0,l.useState)(t.viewBox),[b,j]=(0,l.useState)(!1),[v,w]=(0,l.useState)({x:0,y:0}),N=(0,l.useCallback)((e,s)=>{var n;s.stopPropagation();let l=t.nodes.find(t=>t.id===e);if(!l)return;x(!0),m(e),i(e);let a=null==(n=r.current)?void 0:n.getBoundingClientRect();if(a){let e=(s.clientX-a.left)*(g.width/a.width)+g.x,t=(s.clientY-a.top)*(g.height/a.height)+g.y;p({x:e-l.x,y:t-l.y})}},[t.nodes,i,g]),k=(0,l.useCallback)(e=>{if(c&&u){var t;let n=null==(t=r.current)?void 0:t.getBoundingClientRect();if(n){let t=(e.clientX-n.left)*(g.width/n.width)+g.x,l=(e.clientY-n.top)*(g.height/n.height)+g.y;s(u,{x:t-f.x,y:l-f.y})}}else if(b){let t=e.clientX-v.x,s=e.clientY-v.y;y(e=>{var n,l;return{...e,x:e.x-t*(e.width/((null==(n=r.current)?void 0:n.clientWidth)||1)),y:e.y-s*(e.height/((null==(l=r.current)?void 0:l.clientHeight)||1))}}),w({x:e.clientX,y:e.clientY})}},[c,u,f,s,b,v,g]),C=(0,l.useCallback)(()=>{x(!1),m(null),j(!1)},[]),S=(0,l.useCallback)(e=>{e.target===r.current&&(j(!0),w({x:e.clientX,y:e.clientY}),i(null))},[i]),L=(0,l.useCallback)(e=>{if(a&&e.target===r.current){var t;let s=null==(t=r.current)?void 0:t.getBoundingClientRect();s&&o(a,{x:(e.clientX-s.left)*(g.width/s.width)+g.x,y:(e.clientY-s.top)*(g.height/s.height)+g.y})}},[a,o,g]),M=(0,l.useCallback)(e=>{var t;e.preventDefault();let s=e.deltaY>0?1.1:.9,n=null==(t=r.current)?void 0:t.getBoundingClientRect();if(n){let t=(e.clientX-n.left)*(g.width/n.width)+g.x,l=(e.clientY-n.top)*(g.height/n.height)+g.y,i=g.width*s,a=g.height*s;y({x:t-(t-g.x)*s,y:l-(l-g.y)*s,width:i,height:a})}},[g]);return(0,l.useEffect)(()=>{let e=e=>{k(e)},t=()=>{C()};return(c||b)&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",t)),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[c,b,k,C]),(0,n.jsxs)("div",{className:"w-full h-full bg-gray-50 relative overflow-hidden",children:[(0,n.jsxs)("svg",{ref:r,className:"w-full h-full cursor-grab active:cursor-grabbing",viewBox:"".concat(g.x," ").concat(g.y," ").concat(g.width," ").concat(g.height),onMouseDown:S,onDoubleClick:L,onWheel:M,children:[(0,n.jsx)("defs",{children:(0,n.jsx)("pattern",{id:"grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:(0,n.jsx)("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"#e5e7eb",strokeWidth:"0.5"})})}),(0,n.jsx)("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),t.connections.map(e=>(0,n.jsx)(h,{connection:e,nodes:t.nodes},e.id)),t.nodes.map(e=>(0,n.jsx)(d,{node:e,isSelected:a===e.id,onDragStart:N,onSelect:i},e.id))]}),(0,n.jsx)("div",{className:"absolute top-4 left-4 bg-white/90 backdrop-blur-sm rounded-lg p-3 shadow-sm text-sm text-gray-600 max-w-xs",children:(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("div",{children:"• Click and drag nodes to move them"}),(0,n.jsx)("div",{children:"• Double-click canvas to add a node"}),(0,n.jsx)("div",{children:"• Scroll to zoom in/out"}),(0,n.jsx)("div",{children:"• Drag canvas to pan around"})]})}),(0,n.jsxs)("div",{className:"absolute bottom-4 right-4 flex flex-col gap-2",children:[(0,n.jsx)("button",{onClick:()=>y(e=>({...e,width:.8*e.width,height:.8*e.height})),className:"w-10 h-10 bg-white rounded-lg shadow-md flex items-center justify-center hover:bg-gray-50 transition-colors",title:"Zoom In",children:"+"}),(0,n.jsx)("button",{onClick:()=>y(e=>({...e,width:1.2*e.width,height:1.2*e.height})),className:"w-10 h-10 bg-white rounded-lg shadow-md flex items-center justify-center hover:bg-gray-50 transition-colors",title:"Zoom Out",children:"−"}),(0,n.jsx)("button",{onClick:()=>y(t.viewBox),className:"w-10 h-10 bg-white rounded-lg shadow-md flex items-center justify-center hover:bg-gray-50 transition-colors text-xs",title:"Reset View",children:"⌂"})]})]})}var u=s(6874),m=s.n(u);function f(e){var t,s;let{initialMindMap:c}=e,[d,h]=(0,l.useState)(c),[u,f]=(0,l.useState)(null),[p,g]=(0,l.useState)(!1),y=(0,l.useCallback)((e,t)=>{h(s=>({...s,nodes:s.nodes.map(s=>s.id===e?{...s,...t}:s),updatedAt:new Date().toISOString()})),g(!0)},[]),b=(0,l.useCallback)(e=>{f(e)},[]),j=(0,l.useCallback)((e,t)=>{let s="node-".concat(Date.now()),n=d.nodes.find(t=>t.id===e);if(!n)return;let l={id:s,text:"New Idea",x:t.x,y:t.y,type:"central"===n.type?"branch":"leaf",color:n.color,parentId:e,children:[],width:120,height:50},i={id:"conn-".concat(Date.now()),fromNodeId:e,toNodeId:s,style:"solid",color:"#6b7280"};h(e=>({...e,nodes:[...e.nodes,l],connections:[...e.connections,i],updatedAt:new Date().toISOString()})),y(e,{children:[...n.children||[],s]}),f(s),g(!0)},[d.nodes,y]),v=(0,l.useCallback)(()=>{console.log("Saving mind map:",d),g(!1)},[d]),w=(0,l.useCallback)(()=>{let e=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="".concat(d.title.replace(/\s+/g,"_"),".json"),s.click(),URL.revokeObjectURL(t)},[d]),N=u?d.nodes.find(e=>e.id===u):null;return(0,n.jsxs)("div",{className:"min-h-screen bg-background flex flex-col",children:[(0,n.jsx)(r.default,{}),(0,n.jsx)("div",{className:"border-b bg-white",children:(0,n.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)(m(),{href:"/mindmaps",className:"text-muted-foreground hover:text-foreground transition-colors",children:"← Back to Mind Maps"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:d.title}),(0,n.jsx)("p",{className:"text-muted-foreground text-sm",children:d.description})]}),p&&(0,n.jsx)(o.E,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Unsaved Changes"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(i.$,{variant:"outline",onClick:w,children:"Export"}),(0,n.jsx)(i.$,{onClick:v,disabled:!p,children:"Save"})]})]})})}),(0,n.jsxs)("div",{className:"flex-1 flex",children:[(0,n.jsx)("div",{className:"flex-1 relative",children:(0,n.jsx)(x,{mindMap:d,onNodeUpdate:y,onNodeSelect:b,selectedNodeId:u,onAddNode:j})}),(0,n.jsxs)("div",{className:"w-80 border-l bg-white flex flex-col",children:[N?(0,n.jsxs)(a.Zp,{className:"m-4 border-0 shadow-none",children:[(0,n.jsx)(a.aR,{className:"pb-3",children:(0,n.jsx)(a.ZB,{className:"text-lg",children:"Node Properties"})}),(0,n.jsxs)(a.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Text"}),(0,n.jsx)("input",{type:"text",value:N.text,onChange:e=>y(N.id,{text:e.target.value}),className:"w-full px-3 py-2 border rounded-md text-sm",placeholder:"Node text"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Type"}),(0,n.jsxs)("select",{value:N.type,onChange:e=>y(N.id,{type:e.target.value}),className:"w-full px-3 py-2 border rounded-md text-sm",children:[(0,n.jsx)("option",{value:"central",children:"Central"}),(0,n.jsx)("option",{value:"branch",children:"Branch"}),(0,n.jsx)("option",{value:"leaf",children:"Leaf"}),(0,n.jsx)("option",{value:"task",children:"Task"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Color"}),(0,n.jsx)("div",{className:"flex gap-2 flex-wrap",children:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4"].map(e=>(0,n.jsx)("button",{onClick:()=>y(N.id,{color:e}),className:"w-8 h-8 rounded-full border-2 ".concat(N.color===e?"border-gray-800":"border-gray-300"),style:{backgroundColor:e}},e))})]}),"task"===N.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Priority"}),(0,n.jsxs)("select",{value:(null==(t=N.metadata)?void 0:t.priority)||"medium",onChange:e=>y(N.id,{metadata:{...N.metadata,priority:e.target.value}}),className:"w-full px-3 py-2 border rounded-md text-sm",children:[(0,n.jsx)("option",{value:"low",children:"Low"}),(0,n.jsx)("option",{value:"medium",children:"Medium"}),(0,n.jsx)("option",{value:"high",children:"High"}),(0,n.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Assignee"}),(0,n.jsx)("input",{type:"text",value:(null==(s=N.metadata)?void 0:s.assignee)||"",onChange:e=>y(N.id,{metadata:{...N.metadata,assignee:e.target.value}}),className:"w-full px-3 py-2 border rounded-md text-sm",placeholder:"Assignee name"})]})]}),(0,n.jsx)("div",{className:"pt-4 border-t",children:(0,n.jsx)(i.$,{variant:"destructive",size:"sm",className:"w-full",onClick:()=>{console.log("Delete node:",N.id)},children:"Delete Node"})})]})]}):(0,n.jsx)("div",{className:"m-4 p-8 text-center text-muted-foreground",children:(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-3",children:(0,n.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded"})}),(0,n.jsx)("h3",{className:"font-medium mb-2",children:"No Node Selected"}),(0,n.jsx)("p",{className:"text-sm",children:"Click on a node to edit its properties, or double-click the canvas to add a new node."})]})}),(0,n.jsx)("div",{className:"mt-auto p-4 border-t bg-gray-50",children:(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Nodes:"}),(0,n.jsx)("span",{className:"font-medium",children:d.nodes.length})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Connections:"}),(0,n.jsx)("span",{className:"font-medium",children:d.connections.length})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-muted-foreground",children:"Last updated:"}),(0,n.jsx)("span",{className:"font-medium",children:new Date(d.updatedAt).toLocaleDateString()})]})]})})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[173,785,441,684,358],()=>t(4248)),_N_E=e.O()}]);